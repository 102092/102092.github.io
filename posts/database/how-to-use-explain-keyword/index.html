<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>How to use EXPLAIN in mysql | 나뭇가지</title>
<meta name=keywords content="mysql">
<meta name=description content="A brief guide to how to use explain">
<meta name=author content="Han">
<link rel=canonical href=https://102092.github.io/posts/database/how-to-use-explain-keyword/>
<meta name=google-site-verification content="G-M00DV5S2CX">
<link crossorigin=anonymous href=/assets/css/stylesheet.min.6cba0d81b5f3f42bb578d49f402ba4175aa72b43def148780b8ad714c957c6f5.css integrity="sha256-bLoNgbXz9Cu1eNSfQCukF1qnK0Pe8Uh4C4rXFMlXxvU=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://102092.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://102092.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://102092.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://102092.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://102092.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.87.0">
<meta property="og:title" content="How to use EXPLAIN in mysql">
<meta property="og:description" content="A brief guide to how to use explain">
<meta property="og:type" content="article">
<meta property="og:url" content="https://102092.github.io/posts/database/how-to-use-explain-keyword/"><meta property="og:image" content="https://avatars.githubusercontent.com/u/71244638?v=4"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-06-16T00:00:00+00:00">
<meta property="article:modified_time" content="2021-06-16T00:00:00+00:00"><meta property="og:site_name" content="나뭇가지">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://avatars.githubusercontent.com/u/71244638?v=4">
<meta name=twitter:title content="How to use EXPLAIN in mysql">
<meta name=twitter:description content="A brief guide to how to use explain">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://102092.github.io/posts/"},{"@type":"ListItem","position":3,"name":"How to use EXPLAIN in mysql","item":"https://102092.github.io/posts/database/how-to-use-explain-keyword/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to use EXPLAIN in mysql","name":"How to use EXPLAIN in mysql","description":"A brief guide to how to use explain","keywords":["mysql"],"articleBody":"SELECT 쿼리 실행 순서   작성하는 쿼리문의 순서와, 실제 DB에서 실행되는 순서가 다름.\n  보통 Select query 문법 순서\n SELECT FROM WHERE GROUP BY ORDER BY    실제 실행 순서\n FROM  Sub Query.. 있으면 임시테이블 생성됨.   ON JOIN WHERE GROUP BY HAVING SELECT DISTINCT ORDER BY LIMIT, OFFSET    참고\n https://dion-ko.tistory.com/85 https://daeuungcode.tistory.com/144    MySQL Explain  기본적으로 SELECT, INSERT, DELETE, REPLACE, UPDATE 쿼리문의 실행플랜을 분석하는 데 사용하는 키워드. 해당 쿼리를 실제 실행하는 것은 아니고, 데이터베이스에게 어떻게 실행할 건지 계획을 받아보는 방법임. 아래와 같이 사용함.  EXPLAIN SELECT * FROM foo WHERE foo.bar = 'infrastructure as a service' OR foo.bar = 'iaas';  DESCRIBE 라는 방법도 있는 데 이는 Explain이란 동일한 기능인듯.  참고  https://dev.mysql.com/doc/refman/5.7/en/describe.html      Explain 결과 이해하기 table  어떤 테이블에 접근하고 있는지 알려줌.  id  SELECT를 몇번이나 실행하는 지의 숫자를 나타낸 값인듯. 해당 쿼리가 Subquery 또는 Union query를 포함하고 있지 않으면 항상 1의 값을 가짐.  select_type  SELECT Query에 대한 타입 SIMPLE (서브쿼리, 유니온 쿼리 없이 실행된 쿼리) SUBQUERY UNION DERIVED 참고  https://dev.mysql.com/doc/refman/5.7/en/explain-output.html#explain_select_type    partitions  해당 테이블이 파티셔닝 되어있을 경우, 사용되는 필드 NULL 은 해당 쿼리에서 사용되는 테이블이 파티셔닝 되지 않았을을 의미  type   어떻게 해당 테이블에 접근하고 있는가를 나타낸 필드\n  이 필드는 실행될 쿼리의 효율성을 판단하는 데 가장 중요한 필드 임\n  system\n 테이블에 하나의 row만 있을 경우    const\n 테이블에 하나의 매칭된 row만 있을 경우 이 타입은 해당 쿼리가 굉장히 빠르게 실행될 수 있음을 의미    eq_ref\n 조인을 사용할 때 나타나는 타입 이전 테이블과 조인을 할 때, 지금 테이블에서 하나의 로우만이 매칭된다는 의미인듯. Join할 때의 best practice 해당 row가 Prmiary key 혹은 Unique key이면서 NOT NULL인 인덱스 일 경우에 해당 타입이 사용됨.    ref\n 조인을 사용할 때 나타나는 타입 Primary key, Unique key가 아닌 Key와 매칭되는 경우 즉 조인할 때, 하나의 row만으로 되지 않는 경우 만약에 매칭되는 row의 수가 적다면, 이 또한 조인할 경우 좋은 타입이라 말할 수 있음.    ref_or_null\n ref 타입과 비슷 그렇지만 해당 row null 이 포함된 row까지 탐색하고 있다는 뜻임.  SELECT * FROM ref_table WHERE key_column=expr OR key_column IS NULL;  아무래도 null 까지 탐색 조건에 들어가니, ref 타입보다는 별로이지 않을까.    range\n 인덱스를 사용해서, 특정 row 에 범위 접근할 때 사용되는 타입 Explain 결과 colum 중 key 는 해당 인덱스가 가리키고 있는 column임 =, , , =, , , IS NULL, , BETWEEN, LIKE, IN(), 연산자를 사용할 때 보통 나타나는 타입임  SELECT * FROM tbl_name WHERE key_column = 10; SELECT * FROM tbl_name WHERE key_column BETWEEN 10 and 20; SELECT * FROM tbl_name WHERE key_column IN (10,20,30); SELECT * FROM tbl_name WHERE key_part1 = 10 AND key_part2 IN (10,20,30);   ALL\n 전체 행 스캔, 테이블에 존재하는 모든 데이터 접근 대부분의 경우, 이 타입은 좋지 않음 그래서 보통 인덱스를 추가하여, 해당 타입의 사용을 피함    index\n 인덱스 풀 스캔 인덱스를 처음 부터 끝까지 검색하는 경우 이 타입도 좋지 않음.    참고\n https://dev.mysql.com/doc/refman/5.7/en/explain-output.html#explain-join-types    possible_keys  사용 가능성이 있는 인덱스 목록을 말함.  key  possible_keys 항목 중에, 실제 옵티마이저가 사용하겠다고 선택한 인덱스를 의미. 만약 컬럼이 null 이면, 인덱스를 사용할 수 없다는 의미인듯.  key_len  key 필드 인덱스의 길이를 의미. 너무 길면 비효율적이다.  rows  이 전 컬럼들의 접근방식들을 이용하여, 데이터베이스에서 몇개의 row를 가지고 왔는지 의미하는 컬럼 실제 행 수와는 반드시 일치하지는 않는다.  filtered  rows 컬럼의 값이, WHERE 조건을 거쳤을 경우, 몇행이나 남아있는지 알려주는 컬럼. 실제 행 수와는 반드시 일치하지는 않는다.  extra   옵티마이저가 어떻게 동작할 지 알려주는 힌트.\n  이 컬럼이 Using filesort 나 Using Temporary 라는 값이면 해당 쿼리 실행에 성능적인 문제가 있을 수도 있음을 암시한다.\n  Using filesort\n ORDERB BY 조건에 있는 index를 사용할 수 없을 때, 해당 데이터의 정렬을 위해서, MySQL이 추가적인 작업이 필요함을 의미함. 모든 row를 읽고, sort key를 저장한다음에, 정렬하는 작업이 발생함. sort_buffer_size 만큼의 메모리 할당등이 필요하므로.. 엄청나게 많은 rows가 filesort 과정을 거친다면 데이터베이스에 부담이 될 수 있을듯. 참고  https://dev.mysql.com/doc/refman/5.7/en/order-by-optimization.html      Using temporary\n 이 쿼리를 위해, 임시적인 테이블 생성이 필요함을 의미. 보통 이 힌트는, 해당 쿼리의 GROUP BY 와 ORDER BY가 포함되어 있고, 다른 컬럼을 가르킬 경우 발생함.    Using where\n where 조건을 이용하여, rows 행을 filterd 하였음을 의미. type 이 ALL 혹은 index 타입이라면, 해당 쿼리에 뭔가 문제가 있다는 의미    Using index\n 인덱스만을 가지고, 데이터를 추출했음을 의미함. InnoDB 의 경우, user-defined clustered index 를 가지고 있으면 그 인덱스가 Extra 에 나타나있지 않더라도, 사용되어질 수 있음. 단 그 type 은 index 이고, key 가 Primary일 경우    MySQL의 index 사용  참고  https://stackoverflow.com/questions/586381/mysql-not-using-indexes-with-where-in-clause    참고  https://www.exoscale.com/syslog/explaining-mysql-queries/#:~:text=In%20MySQL%2C%20EXPLAIN%20can%20be,as%20a%20service'%20OR%20foo. https://cheese10yun.github.io/mysql-explian/ https://www.eversql.com/mysql-explain-example-explaining-mysql-explain-using-stackoverflow-data/ https://nomadlee.com/mysql-explain-sql/ https://www.sitepoint.com/using-explain-to-write-better-mysql-queries/#:~:text=Extra%20%E2%80%93%20contains%20additional%20information%20regarding,may%20indicate%20a%20troublesome%20query  ","wordCount":"674","inLanguage":"en","datePublished":"2021-06-16T00:00:00Z","dateModified":"2021-06-16T00:00:00Z","author":{"@type":"Person","name":"Han"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://102092.github.io/posts/database/how-to-use-explain-keyword/"},"publisher":{"@type":"Organization","name":"나뭇가지","logo":{"@type":"ImageObject","url":"https://102092.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<noscript>
<style type=text/css>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://102092.github.io accesskey=h title="나뭇가지 (Alt + H)">나뭇가지</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://102092.github.io/archives title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://102092.github.io/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=https://102092.github.io/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://102092.github.io>Home</a>&nbsp;»&nbsp;<a href=https://102092.github.io/posts/>Posts</a></div>
<h1 class=post-title>
How to use EXPLAIN in mysql
</h1>
<div class=post-description>
A brief guide to how to use explain
</div>
<div class=post-meta>June 16, 2021&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Han&nbsp;|&nbsp;<a href=https://github.com/102092/102092.github.io/blob/dev/content/posts/database/how-to-use-explain-keyword.md rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<div class=details>Table of Contents</div>
</summary>
<div class=inner><ul>
<li>
<a href=#select-%ec%bf%bc%eb%a6%ac-%ec%8b%a4%ed%96%89-%ec%88%9c%ec%84%9c aria-label="SELECT 쿼리 실행 순서">SELECT 쿼리 실행 순서</a></li>
<li>
<a href=#mysql-explain aria-label="MySQL Explain">MySQL Explain</a><ul>
<li>
<a href=#explain-%ea%b2%b0%ea%b3%bc-%ec%9d%b4%ed%95%b4%ed%95%98%ea%b8%b0 aria-label="Explain 결과 이해하기">Explain 결과 이해하기</a><ul>
<li>
<a href=#table aria-label=table>table</a></li>
<li>
<a href=#id aria-label=id>id</a></li>
<li>
<a href=#select_type aria-label=select_type>select_type</a></li>
<li>
<a href=#partitions aria-label=partitions>partitions</a></li>
<li>
<a href=#type aria-label=type>type</a></li>
<li>
<a href=#possible_keys aria-label=possible_keys>possible_keys</a></li>
<li>
<a href=#key aria-label=key>key</a></li>
<li>
<a href=#key_len aria-label=key_len>key_len</a></li>
<li>
<a href=#rows aria-label=rows>rows</a></li>
<li>
<a href=#filtered aria-label=filtered>filtered</a></li>
<li>
<a href=#extra aria-label=extra>extra</a></li></ul>
</li></ul>
</li>
<li>
<a href=#mysql%ec%9d%98-index-%ec%82%ac%ec%9a%a9 aria-label="MySQL의 index 사용">MySQL의 index 사용</a></li>
<li>
<a href=#%ec%b0%b8%ea%b3%a0 aria-label=참고>참고</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h1 id=select-쿼리-실행-순서>SELECT 쿼리 실행 순서<a hidden class=anchor aria-hidden=true href=#select-쿼리-실행-순서>#</a></h1>
<ul>
<li>
<p>작성하는 쿼리문의 순서와, 실제 DB에서 실행되는 순서가 다름.</p>
</li>
<li>
<p>보통 Select query 문법 순서</p>
<ol>
<li>SELECT</li>
<li>FROM</li>
<li>WHERE</li>
<li>GROUP BY</li>
<li>ORDER BY</li>
</ol>
</li>
<li>
<p>실제 실행 순서</p>
<ol>
<li>FROM
<ul>
<li>Sub Query.. 있으면 임시테이블 생성됨.</li>
</ul>
</li>
<li>ON</li>
<li>JOIN</li>
<li>WHERE</li>
<li>GROUP BY</li>
<li>HAVING</li>
<li>SELECT</li>
<li>DISTINCT</li>
<li>ORDER BY</li>
<li>LIMIT, OFFSET</li>
</ol>
</li>
<li>
<p>참고</p>
<ul>
<li><a href=https://dion-ko.tistory.com/85>https://dion-ko.tistory.com/85</a></li>
<li><a href=https://daeuungcode.tistory.com/144>https://daeuungcode.tistory.com/144</a></li>
</ul>
</li>
</ul>
<h1 id=mysql-explain>MySQL Explain<a hidden class=anchor aria-hidden=true href=#mysql-explain>#</a></h1>
<ul>
<li>기본적으로 SELECT, INSERT, DELETE, REPLACE, UPDATE 쿼리문의 실행플랜을 분석하는 데 사용하는 키워드.</li>
<li>해당 쿼리를 실제 실행하는 것은 아니고, 데이터베이스에게 어떻게 실행할 건지 계획을 받아보는 방법임.</li>
<li>아래와 같이 사용함.</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>EXPLAIN</span> 
<span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> 
<span style=color:#66d9ef>FROM</span> foo 
<span style=color:#66d9ef>WHERE</span> foo.bar <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;infrastructure as a service&#39;</span> <span style=color:#66d9ef>OR</span> foo.bar <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;iaas&#39;</span>;
</code></pre></div><ul>
<li><code>DESCRIBE</code> 라는 방법도 있는 데 이는 <code>Explain</code>이란 동일한 기능인듯.
<ul>
<li>참고
<ul>
<li><a href=https://dev.mysql.com/doc/refman/5.7/en/describe.html>https://dev.mysql.com/doc/refman/5.7/en/describe.html</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=explain-결과-이해하기>Explain 결과 이해하기<a hidden class=anchor aria-hidden=true href=#explain-결과-이해하기>#</a></h2>
<h3 id=table>table<a hidden class=anchor aria-hidden=true href=#table>#</a></h3>
<ul>
<li>어떤 테이블에 접근하고 있는지 알려줌.</li>
</ul>
<h3 id=id>id<a hidden class=anchor aria-hidden=true href=#id>#</a></h3>
<ul>
<li>SELECT를 몇번이나 실행하는 지의 숫자를 나타낸 값인듯.</li>
<li>해당 쿼리가 Subquery 또는 Union query를 포함하고 있지 않으면 항상 1의 값을 가짐.</li>
</ul>
<h3 id=select_type>select_type<a hidden class=anchor aria-hidden=true href=#select_type>#</a></h3>
<ul>
<li>SELECT Query에 대한 타입</li>
<li>SIMPLE (서브쿼리, 유니온 쿼리 없이 실행된 쿼리)</li>
<li>SUBQUERY</li>
<li>UNION</li>
<li>DERIVED</li>
<li>참고
<ul>
<li><a href=https://dev.mysql.com/doc/refman/5.7/en/explain-output.html#explain_select_type>https://dev.mysql.com/doc/refman/5.7/en/explain-output.html#explain_select_type</a></li>
</ul>
</li>
</ul>
<h3 id=partitions>partitions<a hidden class=anchor aria-hidden=true href=#partitions>#</a></h3>
<ul>
<li>해당 테이블이 파티셔닝 되어있을 경우, 사용되는 필드</li>
<li><code>NULL</code> 은 해당 쿼리에서 사용되는 테이블이 파티셔닝 되지 않았을을 의미</li>
</ul>
<h3 id=type>type<a hidden class=anchor aria-hidden=true href=#type>#</a></h3>
<ul>
<li>
<p>어떻게 해당 테이블에 접근하고 있는가를 나타낸 필드</p>
</li>
<li>
<p>이 필드는 실행될 쿼리의 <strong>효율성</strong>을 판단하는 데 가장 중요한 필드 임</p>
</li>
<li>
<p><code>system</code></p>
<ul>
<li>테이블에 하나의 row만 있을 경우</li>
</ul>
</li>
<li>
<p><code>const</code></p>
<ul>
<li>테이블에 하나의 매칭된 row만 있을 경우</li>
<li>이 타입은 해당 쿼리가 굉장히 빠르게 실행될 수 있음을 의미</li>
</ul>
</li>
<li>
<p><code>eq_ref</code></p>
<ul>
<li>조인을 사용할 때 나타나는 타입</li>
<li>이전 테이블과 조인을 할 때, 지금 테이블에서 하나의 로우만이 매칭된다는 의미인듯.</li>
<li><strong>Join할 때의 best practice</strong></li>
<li>해당 row가 Prmiary key 혹은 Unique key이면서 NOT NULL인 인덱스 일 경우에 해당 타입이 사용됨.</li>
</ul>
</li>
<li>
<p><code>ref</code></p>
<ul>
<li>조인을 사용할 때 나타나는 타입</li>
<li>Primary key, Unique key가 아닌 Key와 매칭되는 경우</li>
<li>즉 조인할 때, 하나의 row만으로 되지 않는 경우</li>
<li>만약에 매칭되는 row의 수가 적다면, 이 또한 조인할 경우 좋은 타입이라 말할 수 있음.</li>
</ul>
</li>
<li>
<p><code>ref_or_null</code></p>
<ul>
<li><code>ref</code> 타입과 비슷</li>
<li>그렇지만 해당 row <code>null</code> 이 포함된 row까지 탐색하고 있다는 뜻임.</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> ref_table
<span style=color:#66d9ef>WHERE</span> key_column<span style=color:#f92672>=</span>expr <span style=color:#66d9ef>OR</span> key_column <span style=color:#66d9ef>IS</span> <span style=color:#66d9ef>NULL</span>;
</code></pre></div><ul>
<li>아무래도 <code>null</code> 까지 탐색 조건에 들어가니, <code>ref</code> 타입보다는 별로이지 않을까.</li>
</ul>
</li>
<li>
<p><code>range</code></p>
<ul>
<li>인덱스를 사용해서, 특정 row 에 범위 접근할 때 사용되는 타입</li>
<li>Explain 결과 colum 중 <code>key</code> 는 해당 인덱스가 가리키고 있는 column임</li>
<li><code>=</code>, <code>&lt;></code>, <code>></code>, <code>>=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>IS NULL</code>, <code>&lt;=></code>, <code>BETWEEN</code>, <code>LIKE</code>, <code>IN()</code>, 연산자를 사용할 때 보통 나타나는 타입임</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> tbl_name
<span style=color:#66d9ef>WHERE</span> key_column <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;

<span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> tbl_name
<span style=color:#66d9ef>WHERE</span> key_column <span style=color:#66d9ef>BETWEEN</span> <span style=color:#ae81ff>10</span> <span style=color:#66d9ef>and</span> <span style=color:#ae81ff>20</span>;

<span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> tbl_name
<span style=color:#66d9ef>WHERE</span> key_column <span style=color:#66d9ef>IN</span> (<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>20</span>,<span style=color:#ae81ff>30</span>);

<span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> tbl_name
<span style=color:#66d9ef>WHERE</span> key_part1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span> <span style=color:#66d9ef>AND</span> key_part2 <span style=color:#66d9ef>IN</span> (<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>20</span>,<span style=color:#ae81ff>30</span>);
</code></pre></div></li>
<li>
<p><code>ALL</code></p>
<ul>
<li>전체 행 스캔, 테이블에 존재하는 모든 데이터 접근</li>
<li>대부분의 경우, 이 타입은 좋지 않음</li>
<li>그래서 보통 인덱스를 추가하여, 해당 타입의 사용을 피함</li>
</ul>
</li>
<li>
<p><code>index</code></p>
<ul>
<li>인덱스 풀 스캔</li>
<li>인덱스를 처음 부터 끝까지 검색하는 경우</li>
<li>이 타입도 좋지 않음.</li>
</ul>
</li>
<li>
<p>참고</p>
<ul>
<li><a href=https://dev.mysql.com/doc/refman/5.7/en/explain-output.html#explain-join-types>https://dev.mysql.com/doc/refman/5.7/en/explain-output.html#explain-join-types</a></li>
</ul>
</li>
</ul>
<h3 id=possible_keys>possible_keys<a hidden class=anchor aria-hidden=true href=#possible_keys>#</a></h3>
<ul>
<li>사용 가능성이 있는 인덱스 목록을 말함.</li>
</ul>
<h3 id=key>key<a hidden class=anchor aria-hidden=true href=#key>#</a></h3>
<ul>
<li><code>possible_keys</code> 항목 중에, 실제 옵티마이저가 사용하겠다고 선택한 인덱스를 의미.</li>
<li>만약 컬럼이 <code>null</code> 이면, 인덱스를 사용할 수 없다는 의미인듯.</li>
</ul>
<h3 id=key_len>key_len<a hidden class=anchor aria-hidden=true href=#key_len>#</a></h3>
<ul>
<li><code>key</code> 필드 인덱스의 길이를 의미.</li>
<li>너무 길면 비효율적이다.</li>
</ul>
<h3 id=rows>rows<a hidden class=anchor aria-hidden=true href=#rows>#</a></h3>
<ul>
<li>이 전 컬럼들의 접근방식들을 이용하여, 데이터베이스에서 몇개의 row를 가지고 왔는지 의미하는 컬럼</li>
<li>실제 행 수와는 반드시 일치하지는 않는다.</li>
</ul>
<h3 id=filtered>filtered<a hidden class=anchor aria-hidden=true href=#filtered>#</a></h3>
<ul>
<li><code>rows</code> 컬럼의 값이, WHERE 조건을 거쳤을 경우, 몇행이나 <strong>남아있는지</strong> 알려주는 컬럼.</li>
<li>실제 행 수와는 반드시 일치하지는 않는다.</li>
</ul>
<h3 id=extra>extra<a hidden class=anchor aria-hidden=true href=#extra>#</a></h3>
<ul>
<li>
<p>옵티마이저가 어떻게 동작할 지 알려주는 힌트.</p>
</li>
<li>
<p>이 컬럼이 <code>Using filesort</code> 나 <code>Using Temporary</code> 라는 값이면 해당 쿼리 실행에 성능적인 문제가 있을 수도 있음을 암시한다.</p>
</li>
<li>
<p><code>Using filesort</code></p>
<ul>
<li><code>ORDERB BY</code> 조건에 있는 index를 사용할 수 없을 때,</li>
<li>해당 데이터의 정렬을 위해서, MySQL이 추가적인 작업이 필요함을 의미함.</li>
<li>모든 row를 읽고, sort key를 저장한다음에, 정렬하는 작업이 발생함.</li>
<li><code>sort_buffer_size</code> 만큼의 메모리 할당등이 필요하므로.. 엄청나게 많은 rows가 filesort 과정을 거친다면 데이터베이스에 부담이 될 수 있을듯.</li>
<li>참고
<ul>
<li><a href=https://dev.mysql.com/doc/refman/5.7/en/order-by-optimization.html>https://dev.mysql.com/doc/refman/5.7/en/order-by-optimization.html</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>Using temporary</code></p>
<ul>
<li>이 쿼리를 위해, 임시적인 테이블 생성이 필요함을 의미.</li>
<li>보통 이 힌트는, 해당 쿼리의 <code>GROUP BY</code> 와 <code>ORDER BY</code>가 포함되어 있고, 다른 컬럼을 가르킬 경우 발생함.</li>
</ul>
</li>
<li>
<p><code>Using where</code></p>
<ul>
<li>where 조건을 이용하여, <code>rows</code> 행을 <code>filterd</code> 하였음을 의미.</li>
<li><code>type</code> 이 <code>ALL</code> 혹은 <code>index</code> 타입이라면, 해당 쿼리에 뭔가 문제가 있다는 의미</li>
</ul>
</li>
<li>
<p><code>Using index</code></p>
<ul>
<li>인덱스만을 가지고, 데이터를 추출했음을 의미함.</li>
<li><code>InnoDB</code> 의 경우, user-defined clustered index 를 가지고 있으면 그 인덱스가 <code>Extra</code> 에 나타나있지 않더라도, 사용되어질 수 있음.</li>
<li>단 그 type 은 <code>index</code> 이고, <code>key</code> 가 Primary일 경우</li>
</ul>
</li>
</ul>
<h1 id=mysql의-index-사용>MySQL의 index 사용<a hidden class=anchor aria-hidden=true href=#mysql의-index-사용>#</a></h1>
<ul>
<li>참고
<ul>
<li><a href=https://stackoverflow.com/questions/586381/mysql-not-using-indexes-with-where-in-clause>https://stackoverflow.com/questions/586381/mysql-not-using-indexes-with-where-in-clause</a></li>
</ul>
</li>
</ul>
<h1 id=참고>참고<a hidden class=anchor aria-hidden=true href=#참고>#</a></h1>
<ul>
<li><a href="https://www.exoscale.com/syslog/explaining-mysql-queries/#:~:text=In%20MySQL%2C%20EXPLAIN%20can%20be,as%20a%20service'%20OR%20foo">https://www.exoscale.com/syslog/explaining-mysql-queries/#:~:text=In%20MySQL%2C%20EXPLAIN%20can%20be,as%20a%20service'%20OR%20foo</a>.</li>
<li><a href=https://cheese10yun.github.io/mysql-explian/>https://cheese10yun.github.io/mysql-explian/</a></li>
<li><a href=https://www.eversql.com/mysql-explain-example-explaining-mysql-explain-using-stackoverflow-data/>https://www.eversql.com/mysql-explain-example-explaining-mysql-explain-using-stackoverflow-data/</a></li>
<li><a href=https://nomadlee.com/mysql-explain-sql/>https://nomadlee.com/mysql-explain-sql/</a></li>
<li><a href="https://www.sitepoint.com/using-explain-to-write-better-mysql-queries/#:~:text=Extra%20%E2%80%93%20contains%20additional%20information%20regarding,may%20indicate%20a%20troublesome%20query">https://www.sitepoint.com/using-explain-to-write-better-mysql-queries/#:~:text=Extra%20%E2%80%93%20contains%20additional%20information%20regarding,may%20indicate%20a%20troublesome%20query</a></li>
</ul>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://102092.github.io/tags/mysql/>mysql</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://102092.github.io/posts/git/git-command/>
<span class=title>« Prev Page</span>
<br>
<span>Git command</span>
</a>
</nav>
</footer><script src=https://utteranc.es/client.js repo=102092/comments issue-term=title theme=github-light crossorigin=anonymous async></script>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://102092.github.io>나뭇가지</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)">
<button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</button>
</a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>